---
import type { BlockContent } from "@/entities/blockContent/model/type";
import type { CallToAction } from "@/entities/callToAction/model/type";
import { GetContacts } from "@/entities/contact/model/queries";
import { GetPage } from "@/entities/page/model/queries";
import { GetRoleWithSkills } from "@/entities/role/model/queries";

import { GetProjects } from "@/features/Project/model/queries";
import TechStack from "@/features/Project/ui/TechStack.astro";
import Main from "@/features/Project/ui/Main.astro";

import MainLayout from "@/widgets/MainLayout/index.astro";
import Intro from "@/widgets/Intro.astro";
import ClickToAction from "@/widgets/ClickToAction.astro";

const page = await GetPage({ name: "project" });
const contacts = await GetContacts();
const roles = await GetRoleWithSkills();
const projects = await GetProjects();

const hero = page.content[0] as BlockContent;
const stack = page.content[1] as BlockContent;
const main = page.content[2] as BlockContent;
const cta = page.content[3] as CallToAction;
---

<MainLayout
  title={page.title}
  keyword={page.keyword}
  description={page.description}
  contacts={contacts}
>
  <Intro data={hero} />
  <TechStack data={stack} roles={roles} />
  <Main data={main} projects={projects} roles={roles} />
  <ClickToAction data={cta} />
</MainLayout>
