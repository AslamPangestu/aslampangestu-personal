---
import { getImageUrl } from "@/shared/lib/sanity-image-url";

const { asset, alt, caption } = Astro.props.node;

const baseImage = getImageUrl(asset);

const url = baseImage.url();
const webpUrl = baseImage.format("webp").url();
---

<figure class="my-8">
  <picture>
    <source srcset={webpUrl} type="image/webp" />
    <img class="responsive__img rounded-lg shadow-md" src={url} alt={alt} />
  </picture>
  {
    caption && (
      <figcaption class="mt-2 text-center text-sm text-gray-500 italic">
        {caption}
      </figcaption>
    )
  }
</figure>
