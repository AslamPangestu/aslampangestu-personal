---
import { Image } from "astro:assets";

import { ROUTES } from "@/shared/config/route";

import ToggleDarkMode from "./ToggleDarkMode";

const currentPath = new URL(Astro.request.url).pathname;
---

<header
  class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 ease-in-out"
>
  <div
    class="flex flex-row justify-between items-center py-8 px-6 lg:px-8 container w-full mx-auto"
  >
    <div class="basis-1/2 lg:basis-1/4">
      <a href="/" class="w-[78px] h-[48px] block">
        <Image src="/images/logo.svg" alt="Logo" width={78} height={48} />
      </a>
    </div>
    <nav class="hidden lg:block lg:basis-1/2">
      <ul class="flex justify-center flex-row gap-20">
        {
          ROUTES.map((route) => {
            const selected = currentPath === route.href;
            return (
              <li class="flex justify-center items-center">
                {selected ? (
                  <span class="font-semibold text-lg text-primary">
                    {route.name}
                  </span>
                ) : (
                  <a
                    href={route.href}
                    class="font-semibold text-lg text-on-surface-secondary dark:text-surface hover:text-primary hover:underline transition-all duration-300 ease-in-out"
                  >
                    {route.name}
                  </a>
                )}
              </li>
            );
          })
        }
      </ul>
    </nav>
    <div class="lg:hidden basis-1/2 flex flex-row justify-end">
      <span>Menu</span>
    </div>
    <div class="hidden lg:basis-1/4 lg:flex lg:justify-end">
      <ToggleDarkMode client:only="react" />
    </div>
  </div>
</header>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const header = document.getElementsByTagName("header")[0];
    if (window.scrollY >= 120) {
      header.classList.add(
        "bg-surface/10",
        "backdrop-blur-md",
        "dark:bg-surface-900/50",
      );
      header.classList.remove("bg-transparent", "backdrop-blur-0");
    } else {
      header.classList.add("bg-transparent", "backdrop-blur-0");
      header.classList.remove(
        "bg-surface/10",
        "backdrop-blur-md",
        "dark:bg-surface-900/50",
      );
    }
  });
  window.addEventListener("scroll", () => {
    const header = document.getElementsByTagName("header")[0];
    if (window.scrollY >= 120) {
      header.classList.add(
        "bg-surface/10",
        "backdrop-blur-md",
        "dark:bg-surface-900/50",
      );
      header.classList.remove("bg-transparent", "backdrop-blur-0");
    } else {
      header.classList.add("bg-transparent", "backdrop-blur-0");
      header.classList.remove(
        "bg-surface/10",
        "backdrop-blur-md",
        "dark:bg-surface-900/50",
      );
    }
  });
</script>
